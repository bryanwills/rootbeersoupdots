#%Module

module-whatis Homebrew environment setup
module-help This encapsulates `brew shellenv` as a module and sets other environment configurations

switch -- [uname sysname] {
    Darwin {
        switch -- [uname machine] {
            arm64  { set brew_prefix [file join /opt homebrew] }
            x86_64 { set brew_prefix [file join /usr local]    }
        }
        set shellenv_source_prefix $brew_prefix
    }
    Linux {
        set brew_prefix [file join [file home linuxbrew] .linuxbrew]
        set shellenv_source_prefix [file join $brew_prefix Homebrew]
    }
}

set brew [file join $brew_prefix bin brew]

source-cmd [list $brew shellenv]

setenv HOMEBREW_BUNDLE_FILE       [file join $XDG_DATA_HOME homebrew Brewfile]
setenv HOMEBREW_CURLRC            [file join $XDG_CONFIG_HOME curlrc]
setenv HOMEBREW_FORCE_BREWED_CURL 1
setenv HOMEBREW_NO_AUTO_UPDATE    1
